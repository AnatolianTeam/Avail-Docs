"use strict";(self.webpackChunkavail_doc=self.webpackChunkavail_doc||[]).push([[5344],{784:(e,a,t)=>{t.r(a),t.d(a,{assets:()=>l,contentTitle:()=>s,default:()=>h,frontMatter:()=>o,metadata:()=>i,toc:()=>d});var n=t(5893),r=t(1151);t(4996);const o={id:"monitor",title:"Avail Do\u011frulay\u0131c\u0131 Node Nas\u0131l \u0130zlenir?",sidebar_label:"Do\u011frulay\u0131c\u0131n\u0131z\u0131 \u0130zleyin",sidebar_position:6,"a\xe7\u0131klama":"Do\u011frulay\u0131c\u0131y\u0131 izleme hakk\u0131nda bilgi edinin",keywords:["docs","avail","node","validator","monitoring"],image:"https://docs.availproject.org/img/avail/AvailDocs.png"},s=void 0,i={id:"operate-a-node/become-a-validator/monitor",title:"Avail Do\u011frulay\u0131c\u0131 Node Nas\u0131l \u0130zlenir?",description:"Telemetry",source:"@site/docs/operate-a-node/become-a-validator/0050-validator-monitoring.md",sourceDirName:"operate-a-node/become-a-validator",slug:"/operate-a-node/become-a-validator/monitor",permalink:"/operate-a-node/become-a-validator/monitor",draft:!1,unlisted:!1,tags:[],version:"current",sidebarPosition:6,frontMatter:{id:"monitor",title:"Avail Do\u011frulay\u0131c\u0131 Node Nas\u0131l \u0130zlenir?",sidebar_label:"Do\u011frulay\u0131c\u0131n\u0131z\u0131 \u0130zleyin",sidebar_position:6,"a\xe7\u0131klama":"Do\u011frulay\u0131c\u0131y\u0131 izleme hakk\u0131nda bilgi edinin",keywords:["docs","avail","node","validator","monitoring"],image:"https://docs.availproject.org/img/avail/AvailDocs.png"},sidebar:"tutorialSidebar",previous:{title:"Do\u011frulay\u0131c\u0131n\u0131z\u0131 Y\xfckseltin",permalink:"/operate-a-node/become-a-validator/upgrade"},next:{title:"Chill Your Validator",permalink:"/operate-a-node/become-a-validator/chill"}},l={},d=[{value:"Telemetry",id:"telemetry",level:2},{value:"Monitoring with Prometheus &amp; Grafana",id:"monitoring-with-prometheus--grafana",level:2},{value:"Install Prometheus",id:"install-prometheus",level:3},{value:"Install Grafana",id:"install-grafana",level:3},{value:"Setup Grafana Dashboard",id:"setup-grafana-dashboard",level:3}];function c(e){const a={a:"a",code:"code",h2:"h2",h3:"h3",p:"p",pre:"pre",strong:"strong",...(0,r.a)(),...e.components};return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(a.h2,{id:"telemetry",children:"Telemetry"}),"\n",(0,n.jsx)(a.p,{children:"Maintaining a healthy, stable, and secure ecosystem involves closely monitoring network operations and performance. In the case of Avail nodes, they come equipped with built-in low-level\ntelemetry components that automatically gather and transmit detailed information about each node's operation within the network. This backend telemetry data is streamed in real-time to a\ndesignated endpoint, allowing you to observe information regarding your nodes behavior."}),"\n",(0,n.jsxs)(a.p,{children:["Avail project has made available a ",(0,n.jsx)(a.a,{href:"http://telemetry.avail.tools/",children:"public telemetry"})," for anyone to view the status of their nodes. This should not replace your own monitoring and alerts. However it is a key tool that anyone can use to view the status\nof their nodes at anytime."]}),"\n",(0,n.jsx)("img",{src:"/img/avail/validator-avail-telemetry.png",width:"100%",height:"100%"}),"\n",(0,n.jsxs)(a.p,{children:["Avail telemetry has been added to the chain specification file and should automatically send telemetry data to Avail ",(0,n.jsx)(a.a,{href:"http://telemetry.avail.tools/",children:"public telemetry"}),". You can however also\nadd the telemetry ",(0,n.jsx)(a.code,{children:"--telemetry-url 'ws://telemetry.avail.tools:8001/submit/ 0'"})," to your avail node start command if your node is not visible on the public telemetry."]}),"\n",(0,n.jsxs)(a.p,{children:["You can also use ",(0,n.jsx)(a.code,{children:"--name <Validator Node Name>"})," to set the name that will display on telemetry. Without this it will display a random node name on the telemetry."]}),"\n",(0,n.jsx)(a.p,{children:"For example:"}),"\n",(0,n.jsx)(a.pre,{children:(0,n.jsx)(a.code,{children:"./data-avail --validator \\\n    --port 30333 \\\n    --base-path `pwd`/data \\\n    --chain `pwd`/chainspec.raw.json \\\n    --name AvailNode \\\n    --telemetry-url 'ws://telemetry.avail.tools:8001/submit/ 0'\n"})}),"\n",(0,n.jsx)(a.h2,{id:"monitoring-with-prometheus--grafana",children:"Monitoring with Prometheus & Grafana"}),"\n",(0,n.jsx)(a.p,{children:"Prometheus serves as a monitoring platform that gathers metrics from monitored targets through scraping their metrics HTTP endpoints. In contrast, Grafana acts as a visualization dashboard specifically designed to present the collected data in an easily understandable and visually appealing manner."}),"\n",(0,n.jsxs)(a.p,{children:["The below guide is for setting up a local Prometheus & Grafana instance on the same server as your Avail node. If you're already experienced with Prometheus & Grafana and want to connect your Avail node to an existing Prometheus installation on a different server, include the ",(0,n.jsx)(a.code,{children:"--prometheus-external"})," flag in your Avail node's startup command."]}),"\n",(0,n.jsx)(a.h3,{id:"install-prometheus",children:"Install Prometheus"}),"\n",(0,n.jsx)(a.p,{children:"Install prometheus and prometheus node exporter."}),"\n",(0,n.jsx)(a.pre,{children:(0,n.jsx)(a.code,{children:"sudo apt-get install -y prometheus prometheus-node-exporter\n"})}),"\n",(0,n.jsx)(a.p,{children:"Create the prometheus.yml config file"}),"\n",(0,n.jsx)(a.pre,{children:(0,n.jsx)(a.code,{children:'cat > $HOME/prometheus.yml << EOF\nglobal:\n  scrape_interval: 15s\n  evaluation_interval: 15s\n\nrule_files:\n  # - "first.rules"\n  # - "second.rules"\n\nscrape_configs:\n  - job_name: "prometheus"\n    scrape_interval: 5s\n    static_configs:\n      - targets: ["localhost:9090"]\n  - job_name: "avail_node"\n    scrape_interval: 5s\n    static_configs:\n      - targets: ["localhost:9615"]\n  - job_name: node\n    static_configs:\n      - targets: [\'localhost:9100\']\nEOF\n'})}),"\n",(0,n.jsxs)(a.p,{children:["Move ",(0,n.jsx)(a.code,{children:"prometheus.yml"})," to the correct location"]}),"\n",(0,n.jsx)(a.pre,{children:(0,n.jsx)(a.code,{children:"sudo mv $HOME/prometheus.yml /etc/prometheus/prometheus.yml\n"})}),"\n",(0,n.jsx)(a.p,{children:"Update the file permissions"}),"\n",(0,n.jsx)(a.pre,{children:(0,n.jsx)(a.code,{children:"sudo chmod 644 /etc/prometheus/prometheus.yml\n"})}),"\n",(0,n.jsx)(a.p,{children:"Ensure Prometheus starts automatically"}),"\n",(0,n.jsx)(a.pre,{children:(0,n.jsx)(a.code,{children:"sudo systemctl enable prometheus.service prometheus-node-exporter.service\n"})}),"\n",(0,n.jsx)(a.p,{children:"Restart Prometheus to activate latest settings"}),"\n",(0,n.jsx)(a.pre,{children:(0,n.jsx)(a.code,{children:"sudo systemctl restart prometheus.service prometheus-node-exporter.service\n"})}),"\n",(0,n.jsx)(a.p,{children:"Check the status, ensure Prometheus has started without errors"}),"\n",(0,n.jsx)(a.pre,{children:(0,n.jsx)(a.code,{children:"sudo systemctl status prometheus.service prometheus-node-exporter.service\n"})}),"\n",(0,n.jsx)(a.h3,{id:"install-grafana",children:"Install Grafana"}),"\n",(0,n.jsx)(a.p,{children:"Install Grafana"}),"\n",(0,n.jsx)(a.pre,{children:(0,n.jsx)(a.code,{children:'wget -q -O - https://packages.grafana.com/gpg.key | sudo apt-key add -\necho "deb https://packages.grafana.com/oss/deb stable main" > grafana.list\nsudo mv grafana.list /etc/apt/sources.list.d/grafana.list\nsudo apt-get update && sudo apt-get install -y grafana\n'})}),"\n",(0,n.jsx)(a.p,{children:"Ensure Grafana starts automatically"}),"\n",(0,n.jsx)(a.pre,{children:(0,n.jsx)(a.code,{children:"sudo systemctl enable grafana-server.service\n"})}),"\n",(0,n.jsx)(a.p,{children:"Start Grafana"}),"\n",(0,n.jsx)(a.pre,{children:(0,n.jsx)(a.code,{children:"sudo systemctl start grafana-server.service\n"})}),"\n",(0,n.jsx)(a.p,{children:"Check the status, ensure Grafana has started without errors"}),"\n",(0,n.jsx)(a.pre,{children:(0,n.jsx)(a.code,{children:"sudo systemctl status grafana-server.service\n"})}),"\n",(0,n.jsx)(a.h3,{id:"setup-grafana-dashboard",children:"Setup Grafana Dashboard"}),"\n",(0,n.jsx)(a.p,{children:"Ensure port 3000 is open, example of adding to ubuntu firewall"}),"\n",(0,n.jsx)(a.pre,{children:(0,n.jsx)(a.code,{children:"sudo ufw allow 3000/tcp\n"})}),"\n",(0,n.jsxs)(a.p,{children:["In your browser navigate to ",(0,n.jsx)(a.code,{children:"http://<your validators ip address>:3000"}),". The default login username and password is admin/admin"]}),"\n",(0,n.jsx)("img",{src:"/img/avail/validator-avail-grafana.png",width:"100%",height:"100%"}),"\n",(0,n.jsx)(a.p,{children:"You will be asked to reset your password, please write it down or remember the password as you will need it for the next login."}),"\n",(0,n.jsxs)(a.p,{children:["You will need to create a datasource. Navigate to ",(0,n.jsx)(a.strong,{children:"Home->Connections->Data sources"})]}),"\n",(0,n.jsx)("img",{src:"/img/avail/validator-avail-grafana-add-data-source.png",width:"100%",height:"100%"}),"\n",(0,n.jsxs)(a.p,{children:["Click on ",(0,n.jsx)(a.strong,{children:"Add data source"})]}),"\n",(0,n.jsx)("img",{src:"/img/avail/validator-avail-grafana-add-data-source-2.png",width:"100%",height:"100%"}),"\n",(0,n.jsxs)(a.p,{children:["Click on ",(0,n.jsx)(a.strong,{children:"Prometheus"})]}),"\n",(0,n.jsx)("img",{src:"/img/avail/validator-avail-grafana-add-data-source-3.png",width:"100%",height:"100%"}),"\n",(0,n.jsx)(a.p,{children:'Set URL to "localhost:9090", then test and save the connection'}),"\n",(0,n.jsx)("img",{src:"/img/avail/validator-avail-grafana-add-data-source-4.png",width:"100%",height:"100%"}),"\n",(0,n.jsxs)(a.p,{children:["Navigate back to your home page, on the top right in the menu select ",(0,n.jsx)(a.strong,{children:"Import dashboard"})]}),"\n",(0,n.jsx)("img",{src:"/img/avail/validator-avail-grafana-add-dashboard.png",width:"100%",height:"100%"}),"\n",(0,n.jsx)(a.p,{children:"Import the Avail Node Metrics file"}),"\n",(0,n.jsx)("img",{src:"/img/avail/validator-avail-grafana-add-dashboard-2.png",width:"100%",height:"100%"}),"\n",(0,n.jsx)(a.p,{children:"You will have a new dashboard that opens and that you can use to monitor your node"}),"\n",(0,n.jsx)("img",{src:"/img/avail/validator-avail-grafana-add-dashboard-3.png",width:"100%",height:"100%"})]})}function h(e={}){const{wrapper:a}={...(0,r.a)(),...e.components};return a?(0,n.jsx)(a,{...e,children:(0,n.jsx)(c,{...e})}):c(e)}},1151:(e,a,t)=>{t.d(a,{Z:()=>i,a:()=>s});var n=t(7294);const r={},o=n.createContext(r);function s(e){const a=n.useContext(o);return n.useMemo((function(){return"function"==typeof e?e(a):{...a,...e}}),[a,e])}function i(e){let a;return a=e.disableParentContext?"function"==typeof e.components?e.components(r):e.components||r:s(e.components),n.createElement(o.Provider,{value:a},e.children)}}}]);